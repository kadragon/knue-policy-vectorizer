# KNUE Policy Vectorizer Environment Configuration

# ğŸ”§ Provider Selection (Multi-Provider Support)
EMBEDDING_PROVIDER=ollama        # ollama, openai
VECTOR_PROVIDER=qdrant_local     # qdrant_local, qdrant_cloud

# Ollama Configuration (Local Embeddings)
OLLAMA_URL=http://localhost:11434
OLLAMA_MODEL=bge-m3              # Also: EMBEDDING_MODEL (legacy)

# OpenAI Configuration (Cloud Embeddings) - NEW
OPENAI_API_KEY=                  # Required when EMBEDDING_PROVIDER=openai
OPENAI_MODEL=text-embedding-3-small  # text-embedding-3-small, text-embedding-3-large
OPENAI_BASE_URL=https://api.openai.com/v1  # Optional, for custom endpoints

# Qdrant Local Configuration
QDRANT_URL=http://localhost:6333

# Qdrant Cloud Configuration (NEW)
QDRANT_CLOUD_URL=               # https://your-cluster.qdrant.tech
QDRANT_API_KEY=                 # Required when VECTOR_PROVIDER=qdrant_cloud

# Git Repository Configuration
GIT_REPO_URL=https://github.com/KNUE-CS/KNUE-Policy-Hub.git
GIT_BRANCH=main
REPO_CACHE_DIR=./repo_cache

# Collection Configuration
COLLECTION_NAME=knue_policies
VECTOR_SIZE=1024                 # Auto-adjusted based on provider: bge-m3(1024), openai-small(1536), openai-large(3072)

# KNUE Board Collection
QDRANT_BOARD_COLLECTION=www-board-data

# Logging Configuration
LOG_LEVEL=INFO
LOG_FILE=logs/vectorizer.log

# Processing Configuration
MAX_TOKEN_LENGTH=8192
MAX_DOCUMENT_CHARS=30000
CHUNK_THRESHOLD=800
CHUNK_OVERLAP=200
BATCH_SIZE=10

# KNUE Board Ingest
# Template and indices for KNUE board RSS
BOARD_RSS_TEMPLATE=https://www.knue.ac.kr/rssBbsNtt.do?bbsNo={board_idx}
# Comma-separated list of board indices
BOARD_INDICES=25,26,11,207,28,256
# Only ingest posts newer than N days
BOARD_MAX_AGE_DAYS=1
# Retention in days; delete older points during board-sync (default 730 ~ 2 years)
# BOARD_RETENTION_DAYS=730
# ê²Œì‹œíŒë„ ì „ì—­ CHUNK_THRESHOLD/CHUNK_OVERLAP ì„¤ì •ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.

# Batch size for embedding calls during board ingest (optimize API throughput)
# BOARD_EMBED_BATCH_SIZE=32
# Adaptive batching retry/backoff settings
# Maximum retries per sub-batch and base backoff seconds
# BOARD_EMBED_RETRY_MAX=3
# BOARD_EMBED_BACKOFF_BASE=0.5

# Board-specific skip rules: JSON map of board_idx -> list of title prefixes to skip
# Example: skip posts starting with "[êµìœ¡ë´‰ì‚¬]" on board 807
# BOARD_SKIP_PREFIX_MAP={"807":["[êµìœ¡ë´‰ì‚¬]"]}

# Docker-specific overrides (when running in Docker)
# QDRANT_URL=http://qdrant:6333
# OLLAMA_URL=http://host.docker.internal:11434
